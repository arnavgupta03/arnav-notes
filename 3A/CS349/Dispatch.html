<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2024-02-25 Sun 01:22 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dispatch</title>
<meta name="author" content="Arnav Gupta" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Dispatch</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgd6ba157">1. Dispatch</a>
<ul>
<li><a href="#orga4e186e">1.1. View Hierarchy</a></li>
<li><a href="#orgf111015">1.2. Event Dispatch</a>
<ul>
<li><a href="#orgb0dd34e">1.2.1. Steps</a></li>
</ul>
</li>
<li><a href="#org6d77406">1.3. Target Selection</a>
<ul>
<li><a href="#org4da13c7">1.3.1. Positional Dispatch</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org19c995e">2. Binding</a>
<ul>
<li><a href="#org4fee59f">2.1. Inheritance Binding</a>
<ul>
<li><a href="#orgedd8f70">2.1.1. Problems</a></li>
</ul>
</li>
<li><a href="#org6914235">2.2. Listener Model Binding</a></li>
</ul>
</li>
<li><a href="#org2627d18">3. Propagation</a>
<ul>
<li><a href="#org34aa006">3.1. Positional Dispatch Limitations</a></li>
<li><a href="#org9c05a3b">3.2. Focus Dispatch</a></li>
<li><a href="#orgddd6150">3.3. Mouse Enter and Exit Events</a>
<ul>
<li><a href="#org1f0cc68">3.3.1. Approach</a></li>
</ul>
</li>
<li><a href="#orgda4cce8">3.4. Global Event Queue Hooks</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgd6ba157" class="outline-2">
<h2 id="orgd6ba157"><span class="section-number-2">1.</span> Dispatch</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orga4e186e" class="outline-3">
<h3 id="orga4e186e"><span class="section-number-3">1.1.</span> View Hierarchy</h3>
<div class="outline-text-3" id="text-1-1">
<p>
UI toolkits typically organize widgets into a tree with only one root element,
that need container widgets for non-leaf nodes.
</p>

<p>
The child order dictates draw order.
</p>
</div>
</div>
<div id="outline-container-orgf111015" class="outline-3">
<h3 id="orgf111015"><span class="section-number-3">1.2.</span> Event Dispatch</h3>
<div class="outline-text-3" id="text-1-2">
<p>
To route an event to the appropriate widget or code
</p>
</div>
<div id="outline-container-orgb0dd34e" class="outline-4">
<h4 id="orgb0dd34e"><span class="section-number-4">1.2.1.</span> Steps</h4>
<div class="outline-text-4" id="text-1-2-1">
<ol class="org-ol">
<li>Target selection: the frontmost widget under the mouse</li>
<li>Route construction: path from root to target node</li>
<li>Propagation
<ol class="org-ol">
<li>capture down from root to target</li>
<li>bubble up from target to root</li>
</ol></li>
</ol>

<p>
Route construction and propagation only apply to positional dispatch.
</p>
</div>
</div>
</div>
<div id="outline-container-org6d77406" class="outline-3">
<h3 id="org6d77406"><span class="section-number-3">1.3.</span> Target Selection</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Determined by the type of event:
</p>
<ul class="org-ul">
<li><b>mouse event</b>: target is the node at the location of the cursor
(mousedown target used), called <b>positional dispatch</b></li>
<li><b>key event</b>: target is the node that has focus, which is typically assigned
with mouse click, called <b>focus dispatch</b></li>
<li><b>touch events</b>: target selection may be more complex, such as a continuous
gesture (like pinch to zoom) or a swipe (like swipe right)</li>
</ul>
</div>
<div id="outline-container-org4da13c7" class="outline-4">
<h4 id="org4da13c7"><span class="section-number-4">1.3.1.</span> Positional Dispatch</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
Target is last widget drawn under mouse.
</p>

<p>
Route is from root to target.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org19c995e" class="outline-2">
<h2 id="org19c995e"><span class="section-number-2">2.</span> Binding</h2>
<div class="outline-text-2" id="text-2">
<p>
How events are associated with code.
</p>

<p>
Design goals of event handling mechanisms:
</p>
<ul class="org-ul">
<li>easy to understand (clear connection between event and code)</li>
<li>easy to implement (binding paradigm or API)</li>
<li>easy to debug (how an event got somewhere)</li>
<li>good performance</li>
</ul>

<p>
Common implementations are:
</p>
<ul class="org-ul">
<li><code>switch</code> statement binding in run loop or global event</li>
</ul>
<p>
callback
</p>
<ul class="org-ul">
<li>disadvantages are difficulty to maintain, events not delegated to an object,
and widgets should handle events themselves</li>
</ul>
</div>
<div id="outline-container-org4fee59f" class="outline-3">
<h3 id="org4fee59f"><span class="section-number-3">2.1.</span> Inheritance Binding</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Event dispatched from a generic OO widget that extends from a base class with
event handling methods that chooses specificity.
</p>
</div>
<div id="outline-container-orgedd8f70" class="outline-4">
<h4 id="orgedd8f70"><span class="section-number-4">2.1.1.</span> Problems</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
Multiple event types are processed through each event method, which is a <code>switch</code>
statement in the widget.
</p>

<p>
No filtering of events might introduce performance issues (ex. all mouse moves
delivered).
</p>

<p>
If using specific event method, doesn&rsquo;t scale well since the base class must be
modified to add new event types.
</p>
</div>
</div>
</div>
<div id="outline-container-org6914235" class="outline-3">
<h3 id="org6914235"><span class="section-number-3">2.2.</span> Listener Model Binding</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Define interfaces for specific event types and create an object that implements
the interface to handle.
</p>

<p>
When event is dispatched, the relevant listener method is called.
</p>
</div>
</div>
</div>
<div id="outline-container-org2627d18" class="outline-2">
<h2 id="org2627d18"><span class="section-number-2">3.</span> Propagation</h2>
<div class="outline-text-2" id="text-3">
<p>
Most UI toolkits support <b>capture</b> (top-down) and <b>bubbling</b> (bottom-up).
</p>

<p>
Any widget in the path can use the event during either pass, and a handler can stop
all following propagation.
</p>

<p>
Capture phase walks down the tree from the root through each widget until it reaches
the target widget.
Bubble phase walks up the tree from the target widget through each ancestor until it
reaches the root.
</p>

<p>
With capture phase, events higher up in the widget tree can filter events (stop
propagation with handled flag).
</p>
</div>
<div id="outline-container-org34aa006" class="outline-3">
<h3 id="org34aa006"><span class="section-number-3">3.1.</span> Positional Dispatch Limitations</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Pure positional dispatch can lead to odd behaviour, since it does not consider
which widget is in focus.
</p>
</div>
</div>
<div id="outline-container-org9c05a3b" class="outline-3">
<h3 id="org9c05a3b"><span class="section-number-3">3.2.</span> Focus Dispatch</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Events dispatched to widget regardless of mouse cursor position, which is needed
for all keyboard and some mouse events.
</p>

<p>
Can have at most one keyboard focus and one mouse focus.
</p>

<p>
Must be able to gain and lose focus at appropriate times.
</p>

<p>
Focus dispatch needs positional dispatch to set focus to widgets.
UI toolkits have dedicated focus managers as part of the dispatch method.
Other ways to request focus are tab key or an app requesting focus itself.
</p>
</div>
</div>
<div id="outline-container-orgddd6150" class="outline-3">
<h3 id="orgddd6150"><span class="section-number-3">3.3.</span> Mouse Enter and Exit Events</h3>
<div class="outline-text-3" id="text-3-3">
<p>
UI toolkits generate events when mouse enters and exits a widget, which is used
for hover effects.
</p>
</div>
<div id="outline-container-org1f0cc68" class="outline-4">
<h4 id="org1f0cc68"><span class="section-number-4">3.3.1.</span> Approach</h4>
<div class="outline-text-4" id="text-3-3-1">
<ol class="org-ol">
<li>Get the element at the very end of the target route.</li>
<li>If that element was not the last element entered, send mouse exit event to
last element entered and mouse enter event to element at end of the route.</li>
</ol>

<p>
If a widget refuses an enter event, the toolkit checks the penultimate
element in the root.
</p>
</div>
</div>
</div>
<div id="outline-container-orgda4cce8" class="outline-3">
<h3 id="orgda4cce8"><span class="section-number-3">3.4.</span> Global Event Queue Hooks</h3>
<div class="outline-text-3" id="text-3-4">
<p>
In some situations, applications can access system events:
</p>
<ul class="org-ul">
<li>monitor fundamental events across all applications</li>
<li>inject fundamental events into another application (can be useful and a
security issue)</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Arnav Gupta</p>
<p class="date">Created: 2024-02-25 Sun 01:22</p>
</div>
</body>
</html>
